import { useState } from 'react'
import { Button, message } from 'antd';
import { imToken } from '../sdk'

function Vote() {
  const [msg, setMsg] = useState('')
  const [loading, setLoading] = useState(false)
  return (
    <div>
      <Button loading={loading} onClick={async () => {
        try {
          message.info("发起交易中...")
          setLoading(true)
          console.log(imToken)
          const result = await imToken.callPromisifyAPI('eos.signTransaction', {
          "signargs": {
              "chainId": "aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906",
              "requiredKeys": [
                  "PUB_K1_5YHwuU7Z3YudKmFZ4FENAUDNja5euxSTtnumordU7roCyyqWMr"
              ],
              "serializedTransaction": {
                  "0": 225,
                  "1": 127,
                  "2": 228,
                  "3": 100,
                  "4": 45,
                  "5": 202,
                  "6": 77,
                  "7": 55,
                  "8": 158,
                  "9": 188,
                  "10": 0,
                  "11": 0,
                  "12": 0,
                  "13": 0,
                  "14": 1,
                  "15": 0,
                  "16": 0,
                  "17": 0,
                  "18": 0,
                  "19": 0,
                  "20": 234,
                  "21": 48,
                  "22": 85,
                  "23": 112,
                  "24": 21,
                  "25": 210,
                  "26": 137,
                  "27": 222,
                  "28": 170,
                  "29": 50,
                  "30": 221,
                  "31": 1,
                  "32": 48,
                  "33": 6,
                  "34": 155,
                  "35": 52,
                  "36": 178,
                  "37": 169,
                  "38": 164,
                  "39": 139,
                  "40": 0,
                  "41": 0,
                  "42": 0,
                  "43": 0,
                  "44": 168,
                  "45": 237,
                  "46": 50,
                  "47": 50,
                  "48": 105,
                  "49": 48,
                  "50": 6,
                  "51": 155,
                  "52": 52,
                  "53": 178,
                  "54": 169,
                  "55": 164,
                  "56": 139,
                  "57": 0,
                  "58": 0,
                  "59": 0,
                  "60": 0,
                  "61": 0,
                  "62": 0,
                  "63": 0,
                  "64": 0,
                  "65": 11,
                  "66": 112,
                  "67": 48,
                  "68": 85,
                  "69": 199,
                  "70": 68,
                  "71": 228,
                  "72": 114,
                  "73": 54,
                  "74": 16,
                  "75": 48,
                  "76": 85,
                  "77": 93,
                  "78": 77,
                  "79": 183,
                  "80": 178,
                  "81": 59,
                  "82": 0,
                  "83": 17,
                  "84": 141,
                  "85": 71,
                  "86": 45,
                  "87": 131,
                  "88": 48,
                  "89": 85,
                  "90": 48,
                  "91": 27,
                  "92": 154,
                  "93": 116,
                  "94": 78,
                  "95": 131,
                  "96": 48,
                  "97": 85,
                  "98": 16,
                  "99": 41,
                  "100": 173,
                  "101": 238,
                  "102": 80,
                  "103": 221,
                  "104": 48,
                  "105": 85,
                  "106": 192,
                  "107": 243,
                  "108": 154,
                  "109": 212,
                  "110": 101,
                  "111": 51,
                  "112": 49,
                  "113": 85,
                  "114": 144,
                  "115": 232,
                  "116": 173,
                  "117": 201,
                  "118": 85,
                  "119": 115,
                  "120": 49,
                  "121": 85,
                  "122": 80,
                  "123": 207,
                  "124": 68,
                  "125": 152,
                  "126": 42,
                  "127": 26,
                  "128": 163,
                  "129": 106,
                  "130": 0,
                  "131": 0,
                  "132": 168,
                  "133": 7,
                  "134": 116,
                  "135": 149,
                  "136": 184,
                  "137": 154,
                  "138": 16,
                  "139": 234,
                  "140": 137,
                  "141": 38,
                  "142": 187,
                  "143": 106,
                  "144": 16,
                  "145": 164,
                  "146": 16,
                  "147": 66,
                  "148": 8,
                  "149": 161,
                  "150": 30,
                  "151": 76,
                  "152": 213,
                  "153": 249,
                  "154": 0
              },
            },
            "txObject": {},
            "chainId": "aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906",
            "broadcast": false
          })         
          setMsg(result)
          setLoading(false)
        } catch(e) {
          console.warn(e)
          setLoading(false)
          setMsg(e.message)
        }
      }}>Vote: {msg}</Button>
    </div>
  )
}

export default Vote
